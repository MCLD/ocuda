function initCrop(n){if(!n.uploadControl){alert("The cropping tool cannot be used without an associated upload control.");return}if(!n.previewCanvas){alert("The cropping tool cannot be used without an associated preview canvas.");return}let t;t=n.cropCanvas?n.cropCanvas:document.createElement("canvas");n.uploadControl.addEventListener("change",function(i){if(i.target.files){if(i.target.files.length>1){alert("Please only select one file.");return}let r=cropDefaultMaxWidth,u=cropDefaultMaxHeight,f=cropDefaultMaxDisplayDimension;n.cropWidth&&(r=n.cropWidth);n.cropHeight&&(u=n.cropHeight);n.displayDimension&&(f=n.displayDimension);let o=i.target.files[0],h=o.type,s=new FileReader,e=document.createElement("img");s.onload=function(i){e.onload=function(i){let o=1;cropCropper&&(cropCropper.destroy(),cropCropper=null);let v=i.target.width<i.target.height?i.target.height:i.target.width;v>f?(o=f/v,document.getElementById("previewContainer").style.maxWidth=i.target.width*o+"px",document.getElementById("previewContainer").style.maxHeight=""):(document.getElementById("previewContainer").style.maxWidth=i.target.width+"px",document.getElementById("previewContainer").style.maxHeight=i.target.height+"px");let l=i.target.width*o,a=i.target.height*o;n.previewCanvas.width=l;n.previewCanvas.height=a;n.previewCanvas.getContext("2d").drawImage(i.target,0,0,l,a);let s=Math.min(l,r),c=Math.min(a,u);if(r===u&&(s=Math.max(s,c),c=s),n.onCropLoad)n.onCropLoad(i.target.width,i.target.height,r,u,s,c);t.getContext("2d").imageSmoothingEnabled=!0;t.getContext("2d").imageSmoothingQuality="high";t.width=s;t.height=c;smartcrop.crop(i.target,{width:s,height:c,ruleOfThirds:!1}).then(function(i){let f=parseInt(i.topCrop.x,10),l=parseInt(i.topCrop.y,10),r=parseInt(i.topCrop.width,10),u=parseInt(i.topCrop.height,10);cropCropper=new Cropper(n.previewCanvas,{aspectRatio:u/r,viewMode:3,dragMode:"move",preview:t,scalable:!1,zoomable:!1,responsive:!1,toggleDragModeOnDblclick:!1,crop:function(i){let r=i.detail.width/o,u=i.detail.height/o;if(t.getContext("2d").drawImage(e,i.detail.x/o,i.detail.y/o,r,u,0,0,s,c),n.onCropResize){let i=Math.floor(r)<s||Math.floor(u)<c;n.onCropResize(t.toDataURL(h),i,r,u)}},data:{x:f*o,y:l*o,width:r*o,height:u*o}})})};e.src=i.target.result};s.readAsDataURL(o)}})}(function(){"use strict";function y(){throw new Error("No native promises and smartcrop.Promise not set.");}function p(n,i){for(var f,r,h,u=n.data,c=i.data,e=n.width,s=n.height,o=0;o<s;o++)for(f=0;f<e;f++)r=(o*e+f)*4,h=f===0||f>=e-1||o===0||o>=s-1?t(u,r):t(u,r)*4-t(u,r-e*4)-t(u,r-4)-t(u,r+4)-t(u,r+e*4),c[r+1]=h}function w(n,t,i){for(var f,u=t.data,l=i.data,s=t.width,a=t.height,e=0;e<a;e++)for(f=0;f<s;f++){var r=(e*s+f)*4,h=o(u[r],u[r+1],u[r+2])/255,c=tt(n,u[r],u[r+1],u[r+2]),v=c>n.skinThreshold,y=h>=n.skinBrightnessMin&&h<=n.skinBrightnessMax;l[r]=v&&y?(c-n.skinThreshold)*(255/(1-n.skinThreshold)):0}}function b(n,t,i){for(var f,u=t.data,l=i.data,s=t.width,a=t.height,e=0;e<a;e++)for(f=0;f<s;f++){var r=(e*s+f)*4,h=o(u[r],u[r+1],u[r+2])/255,c=rt(u[r],u[r+1],u[r+2]),v=c>n.saturationThreshold,y=h>=n.saturationBrightnessMin&&h<=n.saturationBrightnessMax;l[r+2]=y&&v?(c-n.saturationThreshold)*(255/(1-n.saturationThreshold)):0}}function k(n,t){var r,i;if(n.boost){for(r=t.data,i=0;i<t.width;i+=4)r[i+3]=0;for(i=0;i<n.boost.length;i++)d(n.boost[i],n,t)}}function d(n,t,i){for(var r,f,e=i.data,o=i.width,s=~~n.x,h=~~(n.x+n.width),c=~~n.y,l=~~(n.y+n.height),a=n.weight*255,u=c;u<l;u++)for(r=s;r<h;r++)f=(u*o+r)*4,e[f+3]+=a}function g(n,t,r){for(var f,e,o=[],s=i(t,r),h=n.cropWidth||s,c=n.cropHeight||s,u=n.maxScale;u>=n.minScale;u-=n.scaleStep)for(f=0;f+c*u<=r;f+=n.step)for(e=0;e+h*u<=t;e+=n.step)o.push({x:e,y:f,width:h*u,height:c*u});return o}function nt(n,t,i){for(var f,r={detail:0,saturation:0,skin:0,boost:0,total:0},e=t.data,u=n.scoreDownSample,a=1/u,v=t.height*u,y=t.width*u,p=t.width,o=0;o<v;o+=u)for(f=0;f<y;f+=u){var h=(~~(o*a)*p+~~(f*a))*4,c=s(n,i,f,o),l=e[h+1]/255;r.skin+=e[h]/255*(l+n.skinBias)*c;r.detail+=l*c;r.saturation+=e[h+2]/255*(l+n.saturationBias)*c;r.boost+=e[h+3]/255*c}return r.total=(r.detail*n.detailWeight+r.skin*n.skinWeight+r.saturation*n.saturationWeight+r.boost*n.boostWeight)/(i.width*i.height),r}function s(n,t,i,r){if(t.x>i||i>=t.x+t.width||t.y>r||r>=t.y+t.height)return n.outsideImportance;i=(i-t.x)/t.width;r=(r-t.y)/t.height;var u=l(.5-i)*2,f=l(.5-r)*2,s=Math.max(u-1+n.edgeRadius,0),h=Math.max(f-1+n.edgeRadius,0),c=(s*s+h*h)*n.edgeWeight,o=1.41-e(u*u+f*f);return n.ruleOfThirds&&(o+=Math.max(0,o+c+.5)*1.2*(v(u)+v(f))),o+c}function tt(n,t,i,r){var u=e(t*t+i*i+r*r),f=t/u-n.skinColor[0],o=i/u-n.skinColor[1],s=r/u-n.skinColor[2],h=e(f*f+o*o+s*s);return 1-h}function it(n,t){var i={},u=new r(t.width,t.height),e,l,f;p(t,u);w(n,t,u);b(n,t,u);k(n,u);var v=h(u,n.scoreDownSample),c=-Infinity,o=null,s=g(n,t.width,t.height);for(e=0,l=s.length;e<l;e++)f=s[e],f.score=nt(n,v,f),f.score.total>c&&(o=f,c=f.score.total);return i.topCrop=o,n.debug&&o&&(i.crops=s,i.debugOutput=u,i.debugOptions=n,i.debugTopCrop=a({},i.topCrop)),i}function r(n,t,i){this.width=n;this.height=t;this.data=i?new Uint8ClampedArray(i):new Uint8ClampedArray(n*t*4)}function h(n,t){for(var f,c,l,i,u=n.data,nt=n.width,a=Math.floor(n.width/t),p=Math.floor(n.height/t),w=new r(a,p),e=w.data,o=1/(t*t),s=0;s<p;s++)for(f=0;f<a;f++){var h=(s*a+f)*4,b=0,k=0,d=0,g=0,v=0,y=0;for(c=0;c<t;c++)for(l=0;l<t;l++)i=((s*t+c)*nt+(f*t+l))*4,b+=u[i],k+=u[i+1],d+=u[i+2],g+=u[i+3],v=Math.max(v,u[i]),y=Math.max(y,u[i+1]);e[h]=b*o*.5+v*.5;e[h+1]=k*o*.7+y*.3;e[h+2]=d*o;e[h+3]=g*o}return w}function u(n,t){var i=document.createElement("canvas");return i.width=n,i.height=t,i}function c(t){return{open:function(i){var u=i.naturalWidth||i.width,f=i.naturalHeight||i.height,r=t(u,f),e=r.getContext("2d");return i.naturalWidth&&(i.naturalWidth!=i.width||i.naturalHeight!=i.height)?(r.width=i.naturalWidth,r.height=i.naturalHeight):(r.width=i.width,r.height=i.height),e.drawImage(i,0,0),n.Promise.resolve(r)},resample:function(i,r,u){return Promise.resolve(i).then(function(i){var f=t(~~r,~~u),e=f.getContext("2d");return e.drawImage(i,0,0,i.width,i.height,0,0,f.width,f.height),n.Promise.resolve(f)})},getData:function(n){return Promise.resolve(n).then(function(n){var t=n.getContext("2d"),i=t.getImageData(0,0,n.width,n.height);return new r(n.width,n.height,i.data)})}}}function a(n){for(var i,r,t=1,u=arguments.length;t<u;t++)if(i=arguments[t],i)for(r in i)n[r]=i[r];return n}function v(n){return n=((n-1/3+1)%2*.5-.5)*16,Math.max(1-n*n,0)}function o(n,t,i){return.5126*i+.7152*t+.0722*n}function t(n,t){return o(n[t],n[t+1],n[t+2])}function rt(n,t,r){var u=f(n/255,t/255,r/255),e=i(n/255,t/255,r/255),s,o;return u===e?0:(s=(u+e)/2,o=u-e,s>.5?o/(2-u-e):o/(u+e))}var n={};n.Promise=typeof Promise!="undefined"?Promise:y;n.DEFAULTS={width:0,height:0,aspect:0,cropWidth:0,cropHeight:0,detailWeight:.2,skinColor:[.78,.57,.44],skinBias:.01,skinBrightnessMin:.2,skinBrightnessMax:1,skinThreshold:.8,skinWeight:1.8,saturationBrightnessMin:.05,saturationBrightnessMax:.9,saturationThreshold:.4,saturationBias:.2,saturationWeight:.1,scoreDownSample:8,step:8,scaleStep:.1,minScale:1,maxScale:1,edgeRadius:.4,edgeWeight:-20,outsideImportance:-.5,boostWeight:100,ruleOfThirds:!0,prescale:!0,imageOperations:null,canvasFactory:u,debug:!1};n.crop=function(t,r,u){var e=a({},n.DEFAULTS,r);e.aspect&&(e.width=e.aspect,e.height=1);e.imageOperations===null&&(e.imageOperations=c(e.canvasFactory));var h=e.imageOperations,s=1,o=1;return h.open(t,e.input).then(function(n){return e.width&&e.height&&(s=i(n.width/e.width,n.height/e.height),e.cropWidth=~~(e.width*s),e.cropHeight=~~(e.height*s),e.minScale=i(e.maxScale,f(1/s,e.minScale)),e.prescale!==!1&&(o=i(f(256/n.width,256/n.height),1),o<1?(n=h.resample(n,n.width*o,n.height*o),e.cropWidth=~~(e.cropWidth*o),e.cropHeight=~~(e.cropHeight*o),e.boost&&(e.boost=e.boost.map(function(n){return{x:~~(n.x*o),y:~~(n.y*o),width:~~(n.width*o),height:~~(n.height*o),weight:n.weight}}))):o=1)),n}).then(function(n){return h.getData(n).then(function(n){for(var t,i=it(e,n),f=i.crops||[i.topCrop],r=0,s=f.length;r<s;r++)t=f[r],t.x=~~(t.x/o),t.y=~~(t.y/o),t.width=~~(t.width/o),t.height=~~(t.height/o);return u&&u(i),i})})};n.isAvailable=function(t){var i,r;return n.Promise?(i=t?t.canvasFactory:u,i===u&&(r=document.createElement("canvas"),!r.getContext("2d")))?!1:!0:!1};n.importance=s;n.ImgData=r;n._downSample=h;n._canvasImageOperations=c;var i=Math.min,f=Math.max,l=Math.abs,e=Math.sqrt;typeof define!="undefined"&&define.amd&&define(function(){return n});typeof exports!="undefined"?exports.smartcrop=n:typeof navigator!="undefined"&&(window.SmartCrop=window.smartcrop=n);typeof module!="undefined"&&(module.exports=n)})();
/*!
 * Cropper.js v1.5.12
 * https://fengyuanchen.github.io/cropperjs
 *
 * Copyright 2015-present Chen Fengyuan
 * Released under the MIT license
 *
 * Date: 2021-06-12T08:00:17.411Z
 */
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):(n=typeof globalThis!="undefined"?globalThis:n||self,n.Cropper=t())})(this,function(){"use strict";function si(n,t){var r=Object.keys(n),i;return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(n),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(n,t).enumerable})),r.push.apply(r,i)),r}function hi(n){for(var i,t=1;t<arguments.length;t++)i=arguments[t]!=null?arguments[t]:{},t%2?si(Object(i),!0).forEach(function(t){gr(n,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):si(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))});return n}function st(n){"@babel/helpers - typeof";return st=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(n){return typeof n}:function(n){return n&&typeof Symbol=="function"&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n},st(n)}function kr(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}function ci(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}function dr(n,t,i){return t&&ci(n.prototype,t),i&&ci(n,i),n}function gr(n,t,i){return t in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function li(n){return nu(n)||tu(n)||iu(n)||ru()}function nu(n){if(Array.isArray(n))return vt(n)}function tu(n){if(typeof Symbol!="undefined"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function iu(n,t){if(n){if(typeof n=="string")return vt(n,t);var i=Object.prototype.toString.call(n).slice(8,-1);return(i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set")?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?vt(n,t):void 0}}function vt(n,t){(t==null||t>n.length)&&(t=n.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=n[i];return r}function ru(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.");}function n(n){return typeof n=="number"&&!vu(n)}function ui(n){return typeof n=="undefined"}function w(n){return st(n)==="object"&&n!==null}function k(n){if(!w(n))return!1;try{var t=n.constructor,i=t.prototype;return t&&i&&yu.call(i,"isPrototypeOf")}catch(r){return!1}}function e(n){return typeof n=="function"}function cr(n){return Array.from?Array.from(n):pu.call(n)}function r(t,i){return t&&e(i)&&(Array.isArray(t)||n(t.length)?cr(t).forEach(function(n,r){i.call(t,n,r,t)}):w(t)&&Object.keys(t).forEach(function(n){i.call(t,t[n],n,t)})),t}function d(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:1e11;return wu.test(n)?Math.round(n*t)/t:n}function a(t,i){var u=t.style;r(i,function(t,i){bu.test(i)&&n(t)&&(t="".concat(t,"px"));u[i]=t})}function ku(n,t){return n.classList?n.classList.contains(t):n.className.indexOf(t)>-1}function u(t,i){if(i){if(n(t.length)){r(t,function(n){u(n,i)});return}if(t.classList){t.classList.add(i);return}var f=t.className.trim();f?f.indexOf(i)<0&&(t.className="".concat(f," ").concat(i)):t.className=i}}function c(t,i){if(i){if(n(t.length)){r(t,function(n){c(n,i)});return}if(t.classList){t.classList.remove(i);return}t.className.indexOf(i)>=0&&(t.className=t.className.replace(i,""))}}function g(t,i,f){if(i){if(n(t.length)){r(t,function(n){g(n,i,f)});return}f?u(t,i):c(t,i)}}function fi(n){return n.replace(du,"$1-$2").toLowerCase()}function ei(n,t){return w(n[t])?n[t]:n.dataset?n.dataset[t]:n.getAttribute("data-".concat(fi(t)))}function et(n,t,i){w(i)?n[t]=i:n.dataset?n.dataset[t]=i:n.setAttribute("data-".concat(fi(t)),i)}function gu(n,t){if(w(n[t]))try{delete n[t]}catch(i){n[t]=undefined}else if(n.dataset)try{delete n.dataset[t]}catch(i){n.dataset[t]=undefined}else n.removeAttribute("data-".concat(fi(t)))}function s(n,t,i){var u=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},r=i;t.trim().split(lr).forEach(function(t){if(!ar){var f=n.listeners;f&&f[t]&&f[t][i]&&(r=f[t][i],delete f[t][i],Object.keys(f[t]).length===0&&delete f[t],Object.keys(f).length===0&&delete n.listeners)}n.removeEventListener(t,r,u)})}function o(n,t,i){var r=arguments.length>3&&arguments[3]!==undefined?arguments[3]:{},u=i;t.trim().split(lr).forEach(function(t){if(r.once&&!ar){var e=n.listeners,f=e===void 0?{}:e;u=function(){delete f[t][i];n.removeEventListener(t,u,r);for(var o=arguments.length,s=new Array(o),e=0;e<o;e++)s[e]=arguments[e];i.apply(n,s)};f[t]||(f[t]={});f[t][i]&&n.removeEventListener(t,f[t][i],r);f[t][i]=u;n.listeners=f}n.addEventListener(t,u,r)})}function nt(n,t,i){var r;return e(Event)&&e(CustomEvent)?r=new CustomEvent(t,{detail:i,bubbles:!0,cancelable:!0}):(r=document.createEvent("CustomEvent"),r.initCustomEvent(t,!0,!0,i)),n.dispatchEvent(r)}function vr(n){var t=n.getBoundingClientRect();return{left:t.left+(window.pageXOffset-document.documentElement.clientLeft),top:t.top+(window.pageYOffset-document.documentElement.clientTop)}}function yr(n){var t=n.match(nf);return t!==null&&(t[1]!==oi.protocol||t[2]!==oi.hostname||t[3]!==oi.port)}function pr(n){var t="timestamp=".concat((new Date).getTime());return n+(n.indexOf("?")===-1?"?":"&")+t}function ot(t){var u=t.rotate,f=t.scaleX,e=t.scaleY,o=t.translateX,s=t.translateY,i=[],r;return n(o)&&o!==0&&i.push("translateX(".concat(o,"px)")),n(s)&&s!==0&&i.push("translateY(".concat(s,"px)")),n(u)&&u!==0&&i.push("rotate(".concat(u,"deg)")),n(f)&&f!==1&&i.push("scaleX(".concat(f,")")),n(e)&&e!==1&&i.push("scaleY(".concat(e,")")),r=i.length?i.join(" "):"none",{WebkitTransform:r,msTransform:r,transform:r}}function tf(n){var i=hi({},n),t=0;return r(n,function(n,u){delete i[u];r(i,function(i){var r=Math.abs(n.startX-i.startX),u=Math.abs(n.startY-i.startY),f=Math.abs(n.endX-i.endX),e=Math.abs(n.endY-i.endY),o=Math.sqrt(r*r+u*u),h=Math.sqrt(f*f+e*e),s=(h-o)/o;Math.abs(s)>Math.abs(t)&&(t=s)})}),t}function at(n,t){var i=n.pageX,r=n.pageY,u={endX:i,endY:r};return t?u:hi({startX:i,startY:r},u)}function rf(n){var t=0,i=0,u=0;return r(n,function(n){var r=n.startX,f=n.startY;t+=r;i+=f;u+=1}),t/=u,i/=u,{pageX:t,pageY:i}}function v(n){var r=n.aspectRatio,i=n.height,t=n.width,f=arguments.length>1&&arguments[1]!==undefined?arguments[1]:"contain",e=hr(t),o=hr(i),u;return e&&o?(u=i*r,f==="contain"&&u>t||f==="cover"&&u<t?i=t/r:t=i*r):e?i=t/r:o&&(t=i*r),{width:t,height:i}}function uf(n){var i=n.width,r=n.height,t=n.degree;if(t=Math.abs(t)%180,t===90)return{width:r,height:i};var u=t%90*Math.PI/180,f=Math.sin(u),e=Math.cos(u),o=i*e+r*f,s=i*f+r*e;return t>90?{width:s,height:o}:{width:o,height:s}}function ff(n,t,i,r){var s=t.aspectRatio,lt=t.naturalWidth,at=t.naturalHeight,h=t.rotate,vt=h===void 0?0:h,c=t.scaleX,yt=c===void 0?1:c,l=t.scaleY,pt=l===void 0?1:l,a=i.aspectRatio,wt=i.naturalWidth,bt=i.naturalHeight,y=r.fillColor,kt=y===void 0?"transparent":y,p=r.imageSmoothingEnabled,dt=p===void 0?!0:p,w=r.imageSmoothingQuality,gt=w===void 0?"low":w,b=r.maxWidth,k=b===void 0?Infinity:b,g=r.maxHeight,nt=g===void 0?Infinity:g,tt=r.minWidth,it=tt===void 0?0:tt,rt=r.minHeight,ut=rt===void 0?0:rt,f=document.createElement("canvas"),u=f.getContext("2d"),ft=v({aspectRatio:a,width:k,height:nt}),et=v({aspectRatio:a,width:it,height:ut},"cover"),e=Math.min(ft.width,Math.max(et.width,wt)),o=Math.min(ft.height,Math.max(et.height,bt)),ot=v({aspectRatio:s,width:k,height:nt}),st=v({aspectRatio:s,width:it,height:ut},"cover"),ht=Math.min(ot.width,Math.max(st.width,lt)),ct=Math.min(ot.height,Math.max(st.height,at)),ni=[-ht/2,-ct/2,ht,ct];return f.width=d(e),f.height=d(o),u.fillStyle=kt,u.fillRect(0,0,e,o),u.save(),u.translate(e/2,o/2),u.rotate(vt*Math.PI/180),u.scale(yt,pt),u.imageSmoothingEnabled=dt,u.imageSmoothingQuality=gt,u.drawImage.apply(u,[n].concat(li(ni.map(function(n){return Math.floor(d(n))})))),u.restore(),f}function ef(n,t,i){var u="",r;for(i+=t,r=t;r<i;r+=1)u+=wr(n.getUint8(r));return u}function sf(n){var f=n.replace(of,""),t=atob(f),i=new ArrayBuffer(t.length),u=new Uint8Array(i);return r(u,function(n,i){u[i]=t.charCodeAt(i)}),i}function hf(n,t){for(var r=[],u=8192,i=new Uint8Array(n);i.length>0;)r.push(wr.apply(null,cr(i.subarray(0,u)))),i=i.subarray(u);return"data:".concat(t,";base64,").concat(btoa(r.join("")))}function cf(n){var t=new DataView(n),h,i,e,o,a,r,v,u,c,l,y,f,s;try{if(t.getUint8(0)===255&&t.getUint8(1)===216)for(a=t.byteLength,r=2;r+1<a;){if(t.getUint8(r)===255&&t.getUint8(r+1)===225){e=r;break}r+=1}if(e&&(v=e+4,u=e+10,ef(t,v,4)==="Exif"&&(c=t.getUint16(u),i=c===18761,(i||c===19789)&&t.getUint16(u+2,i)===42&&(l=t.getUint32(u+4,i),l>=8&&(o=u+l)))),o)for(y=t.getUint16(o,i),s=0;s<y;s+=1)if(f=o+s*12+2,t.getUint16(f,i)===274){f+=8;h=t.getUint16(f,i);t.setUint16(f,1,i);break}}catch(p){h=1}return h}function lf(n){var t=0,i=1,r=1;switch(n){case 2:i=-1;break;case 3:t=-180;break;case 4:r=-1;break;case 5:t=90;r=-1;break;case 6:t=90;break;case 7:t=90;i=-1;break;case 8:t=-90}return{rotate:t,scaleX:i,scaleY:r}}var ht=typeof window!="undefined"&&typeof document!="undefined",h=ht?window:{},yt=ht&&h.document.documentElement?"ontouchstart"in h.document.documentElement:!1,pt=ht?"PointerEvent"in h:!1,t="cropper",wt="all",ai="crop",vi="move",yi="zoom",y="e",p="w",b="s",l="n",tt="ne",it="nw",rt="se",ut="sw",bt="".concat(t,"-crop"),pi="".concat(t,"-disabled"),f="".concat(t,"-hidden"),wi="".concat(t,"-hide"),uu="".concat(t,"-invisible"),ct="".concat(t,"-modal"),kt="".concat(t,"-move"),ft="".concat(t,"Action"),lt="".concat(t,"Preview"),dt="crop",bi="move",ki="none",gt="crop",ni="cropend",ti="cropmove",ii="cropstart",di="dblclick",fu=yt?"touchstart":"mousedown",eu=yt?"touchmove":"mousemove",ou=yt?"touchend touchcancel":"mouseup",gi=pt?"pointerdown":fu,nr=pt?"pointermove":eu,tr=pt?"pointerup pointercancel":ou,ir="ready",rr="resize",ur="wheel",ri="zoom",fr="image/jpeg",su=/^e|w|s|n|se|sw|ne|nw|all|crop|move|zoom$/,hu=/^data:/,cu=/^data:image\/jpeg;base64,/,lu=/^img|canvas$/i,er=200,or=100,sr={viewMode:0,dragMode:dt,initialAspectRatio:NaN,aspectRatio:NaN,data:null,preview:"",responsive:!0,restore:!0,checkCrossOrigin:!0,checkOrientation:!0,modal:!0,guides:!0,center:!0,highlight:!0,background:!0,autoCrop:!0,autoCropArea:.8,movable:!0,rotatable:!0,scalable:!0,zoomable:!0,zoomOnTouch:!0,zoomOnWheel:!0,wheelZoomRatio:.1,cropBoxMovable:!0,cropBoxResizable:!0,toggleDragModeOnDblclick:!0,minCanvasWidth:0,minCanvasHeight:0,minCropBoxWidth:0,minCropBoxHeight:0,minContainerWidth:er,minContainerHeight:or,ready:null,cropstart:null,cropmove:null,cropend:null,crop:null,zoom:null},au='<div class="cropper-container" touch-action="none"><div class="cropper-wrap-box"><div class="cropper-canvas"><\/div><\/div><div class="cropper-drag-box"><\/div><div class="cropper-crop-box"><span class="cropper-view-box"><\/span><span class="cropper-dashed dashed-h"><\/span><span class="cropper-dashed dashed-v"><\/span><span class="cropper-center"><\/span><span class="cropper-face"><\/span><span class="cropper-line line-e" data-cropper-action="e"><\/span><span class="cropper-line line-n" data-cropper-action="n"><\/span><span class="cropper-line line-w" data-cropper-action="w"><\/span><span class="cropper-line line-s" data-cropper-action="s"><\/span><span class="cropper-point point-e" data-cropper-action="e"><\/span><span class="cropper-point point-n" data-cropper-action="n"><\/span><span class="cropper-point point-w" data-cropper-action="w"><\/span><span class="cropper-point point-s" data-cropper-action="s"><\/span><span class="cropper-point point-ne" data-cropper-action="ne"><\/span><span class="cropper-point point-nw" data-cropper-action="nw"><\/span><span class="cropper-point point-sw" data-cropper-action="sw"><\/span><span class="cropper-point point-se" data-cropper-action="se"><\/span><\/div><\/div>',vu=Number.isNaN||h.isNaN,hr=function(n){return n>0&&n<Infinity},yu=Object.prototype.hasOwnProperty,pu=Array.prototype.slice,i=Object.assign||function(n){for(var i=arguments.length,r=new Array(i>1?i-1:0),t=1;t<i;t++)r[t-1]=arguments[t];return w(n)&&r.length>0&&r.forEach(function(t){w(t)&&Object.keys(t).forEach(function(i){n[i]=t[i]})}),n},wu=/\.\d*(?:0|9){12}\d*$/,bu=/^width|height|left|top|marginLeft|marginTop$/,du=/([a-z\d])([A-Z])/g,lr=/\s\s*/,ar=function(){var n=!1;if(ht){var t=!1,i=function(){},r=Object.defineProperty({},"once",{get:function(){return n=!0,t},set:function(n){t=n}});h.addEventListener("test",i,r);h.removeEventListener("test",i,r)}return n}(),oi=h.location,nf=/^(\w+:)\/\/([^:/?#]*):?(\d*)/i,wr=String.fromCharCode,of=/^data:.*,/,af={render:function(){this.initContainer();this.initCanvas();this.initCropBox();this.renderCanvas();this.cropped&&this.renderCropBox()},initContainer:function(){var i=this.element,r=this.options,e=this.container,t=this.cropper,o=Number(r.minContainerWidth),s=Number(r.minContainerHeight),n;u(t,f);c(i,f);n={width:Math.max(e.offsetWidth,o>=0?o:er),height:Math.max(e.offsetHeight,s>=0?s:or)};this.containerData=n;a(t,{width:n.width,height:n.height});u(i,f);c(t,f)},initCanvas:function(){var t=this.containerData,u=this.imageData,f=this.options.viewMode,s=Math.abs(u.rotate)%180==90,h=s?u.naturalHeight:u.naturalWidth,c=s?u.naturalWidth:u.naturalHeight,r=h/c,e=t.width,o=t.height,n;t.height*r>t.width?f===3?e=t.height*r:o=t.width/r:f===3?o=t.width/r:e=t.height*r;n={aspectRatio:r,naturalWidth:h,naturalHeight:c,width:e,height:o};this.canvasData=n;this.limited=f===1||f===2;this.limitCanvas(!0,!0);n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth);n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight);n.left=(t.width-n.width)/2;n.top=(t.height-n.height)/2;n.oldLeft=n.left;n.oldTop=n.top;this.initialCanvasData=i({},n)},limitCanvas:function(n,t){var a=this.options,e=this.containerData,i=this.canvasData,f=this.cropBoxData,s=a.viewMode,o=i.aspectRatio,h=this.cropped&&f,r,u,y,c,l;n&&(r=Number(a.minCanvasWidth)||0,u=Number(a.minCanvasHeight)||0,s>1?(r=Math.max(r,e.width),u=Math.max(u,e.height),s===3&&(u*o>r?r=u*o:u=r/o)):s>0&&(r?r=Math.max(r,h?f.width:0):u?u=Math.max(u,h?f.height:0):h&&(r=f.width,u=f.height,u*o>r?r=u*o:u=r/o)),y=v({aspectRatio:o,width:r,height:u}),r=y.width,u=y.height,i.minWidth=r,i.minHeight=u,i.maxWidth=Infinity,i.maxHeight=Infinity);t&&(s>(h?0:1)?(c=e.width-i.width,l=e.height-i.height,i.minLeft=Math.min(0,c),i.minTop=Math.min(0,l),i.maxLeft=Math.max(0,c),i.maxTop=Math.max(0,l),h&&this.limited&&(i.minLeft=Math.min(f.left,f.left+(f.width-i.width)),i.minTop=Math.min(f.top,f.top+(f.height-i.height)),i.maxLeft=f.left,i.maxTop=f.top,s===2&&(i.width>=e.width&&(i.minLeft=Math.min(0,c),i.maxLeft=Math.max(0,c)),i.height>=e.height&&(i.minTop=Math.min(0,l),i.maxTop=Math.max(0,l))))):(i.minLeft=-i.width,i.minTop=-i.height,i.maxLeft=e.width,i.maxTop=e.height))},renderCanvas:function(n,t){var r=this.canvasData,u=this.imageData;if(t){var o=uf({width:u.naturalWidth*Math.abs(u.scaleX||1),height:u.naturalHeight*Math.abs(u.scaleY||1),degree:u.rotate||0}),f=o.width,e=o.height,s=r.width*(f/r.naturalWidth),h=r.height*(e/r.naturalHeight);r.left-=(s-r.width)/2;r.top-=(h-r.height)/2;r.width=s;r.height=h;r.aspectRatio=f/e;r.naturalWidth=f;r.naturalHeight=e;this.limitCanvas(!0,!1)}(r.width>r.maxWidth||r.width<r.minWidth)&&(r.left=r.oldLeft);(r.height>r.maxHeight||r.height<r.minHeight)&&(r.top=r.oldTop);r.width=Math.min(Math.max(r.width,r.minWidth),r.maxWidth);r.height=Math.min(Math.max(r.height,r.minHeight),r.maxHeight);this.limitCanvas(!1,!0);r.left=Math.min(Math.max(r.left,r.minLeft),r.maxLeft);r.top=Math.min(Math.max(r.top,r.minTop),r.maxTop);r.oldLeft=r.left;r.oldTop=r.top;a(this.canvas,i({width:r.width,height:r.height},ot({translateX:r.left,translateY:r.top})));this.renderImage(n);this.cropped&&this.limited&&this.limitCropBox(!0,!0)},renderImage:function(n){var r=this.canvasData,t=this.imageData,u=t.naturalWidth*(r.width/r.naturalWidth),f=t.naturalHeight*(r.height/r.naturalHeight);i(t,{width:u,height:f,left:(r.width-u)/2,top:(r.height-f)/2});a(this.image,i({width:t.width,height:t.height},ot(i({translateX:t.left,translateY:t.top},t))));n&&this.output()},initCropBox:function(){var u=this.options,t=this.canvasData,r=u.aspectRatio||u.initialAspectRatio,f=Number(u.autoCropArea)||.8,n={width:t.width,height:t.height};r&&(t.height*r>t.width?n.height=n.width/r:n.width=n.height*r);this.cropBoxData=n;this.limitCropBox(!0,!0);n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth);n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight);n.width=Math.max(n.minWidth,n.width*f);n.height=Math.max(n.minHeight,n.height*f);n.left=t.left+(t.width-n.width)/2;n.top=t.top+(t.height-n.height)/2;n.oldLeft=n.left;n.oldTop=n.top;this.initialCropBoxData=i({},n)},limitCropBox:function(n,t){var c=this.options,u=this.containerData,r=this.canvasData,i=this.cropBoxData,l=this.limited,o=c.aspectRatio;if(n){var f=Number(c.minCropBoxWidth)||0,e=Number(c.minCropBoxHeight)||0,s=l?Math.min(u.width,r.width,r.width+r.left,u.width-r.left):u.width,h=l?Math.min(u.height,r.height,r.height+r.top,u.height-r.top):u.height;f=Math.min(f,u.width);e=Math.min(e,u.height);o&&(f&&e?e*o>f?e=f/o:f=e*o:f?e=f/o:e&&(f=e*o),h*o>s?h=s/o:s=h*o);i.minWidth=Math.min(f,s);i.minHeight=Math.min(e,h);i.maxWidth=s;i.maxHeight=h}t&&(l?(i.minLeft=Math.max(0,r.left),i.minTop=Math.max(0,r.top),i.maxLeft=Math.min(u.width,r.left+r.width)-i.width,i.maxTop=Math.min(u.height,r.top+r.height)-i.height):(i.minLeft=0,i.minTop=0,i.maxLeft=u.width-i.width,i.maxTop=u.height-i.height))},renderCropBox:function(){var t=this.options,r=this.containerData,n=this.cropBoxData;(n.width>n.maxWidth||n.width<n.minWidth)&&(n.left=n.oldLeft);(n.height>n.maxHeight||n.height<n.minHeight)&&(n.top=n.oldTop);n.width=Math.min(Math.max(n.width,n.minWidth),n.maxWidth);n.height=Math.min(Math.max(n.height,n.minHeight),n.maxHeight);this.limitCropBox(!1,!0);n.left=Math.min(Math.max(n.left,n.minLeft),n.maxLeft);n.top=Math.min(Math.max(n.top,n.minTop),n.maxTop);n.oldLeft=n.left;n.oldTop=n.top;t.movable&&t.cropBoxMovable&&et(this.face,ft,n.width>=r.width&&n.height>=r.height?vi:wt);a(this.cropBox,i({width:n.width,height:n.height},ot({translateX:n.left,translateY:n.top})));this.cropped&&this.limited&&this.limitCanvas(!0,!0);this.disabled||this.output()},output:function(){this.preview();nt(this.element,gt,this.getData())}},vf={initPreview:function(){var f=this.element,t=this.crossOrigin,n=this.options.preview,e=t?this.crossOriginUrl:this.url,o=f.alt||"The image to preview",i=document.createElement("img"),u;(t&&(i.crossOrigin=t),i.src=e,i.alt=o,this.viewBox.appendChild(i),this.viewBoxImage=i,n)&&(u=n,typeof n=="string"?u=f.ownerDocument.querySelectorAll(n):n.querySelector&&(u=[n]),this.previews=u,r(u,function(n){var i=document.createElement("img");et(n,lt,{width:n.offsetWidth,height:n.offsetHeight,html:n.innerHTML});t&&(i.crossOrigin=t);i.src=e;i.alt=o;i.style.cssText='display:block;width:100%;height:auto;min-width:0!important;min-height:0!important;max-width:none!important;max-height:none!important;image-orientation:0deg!important;"';n.innerHTML="";n.appendChild(i)}))},resetPreview:function(){r(this.previews,function(n){var t=ei(n,lt);a(n,{width:t.width,height:t.height});n.innerHTML=t.html;gu(n,lt)})},preview:function(){var n=this.imageData,e=this.canvasData,t=this.cropBoxData,u=t.width,f=t.height,o=n.width,s=n.height,h=t.left-e.left-n.left,c=t.top-e.top-n.top;this.cropped&&!this.disabled&&(a(this.viewBoxImage,i({width:o,height:s},ot(i({translateX:-h,translateY:-c},n)))),r(this.previews,function(t){var v=ei(t,lt),y=v.width,e=v.height,p=y,l=e,r=1;u&&(r=y/u,l=f*r);f&&l>e&&(r=e/f,p=u*r,l=e);a(t,{width:p,height:l});a(t.getElementsByTagName("img")[0],i({width:o*r,height:s*r},ot(i({translateX:-h*r,translateY:-c*r},n))))}))}},yf={bind:function(){var t=this.element,n=this.options,i=this.cropper;e(n.cropstart)&&o(t,ii,n.cropstart);e(n.cropmove)&&o(t,ti,n.cropmove);e(n.cropend)&&o(t,ni,n.cropend);e(n.crop)&&o(t,gt,n.crop);e(n.zoom)&&o(t,ri,n.zoom);o(i,gi,this.onCropStart=this.cropStart.bind(this));n.zoomable&&n.zoomOnWheel&&o(i,ur,this.onWheel=this.wheel.bind(this),{passive:!1,capture:!0});n.toggleDragModeOnDblclick&&o(i,di,this.onDblclick=this.dblclick.bind(this));o(t.ownerDocument,nr,this.onCropMove=this.cropMove.bind(this));o(t.ownerDocument,tr,this.onCropEnd=this.cropEnd.bind(this));n.responsive&&o(window,rr,this.onResize=this.resize.bind(this))},unbind:function(){var t=this.element,n=this.options,i=this.cropper;e(n.cropstart)&&s(t,ii,n.cropstart);e(n.cropmove)&&s(t,ti,n.cropmove);e(n.cropend)&&s(t,ni,n.cropend);e(n.crop)&&s(t,gt,n.crop);e(n.zoom)&&s(t,ri,n.zoom);s(i,gi,this.onCropStart);n.zoomable&&n.zoomOnWheel&&s(i,ur,this.onWheel,{passive:!1,capture:!0});n.toggleDragModeOnDblclick&&s(i,di,this.onDblclick);s(t.ownerDocument,nr,this.onCropMove);s(t.ownerDocument,tr,this.onCropEnd);n.responsive&&s(window,rr,this.onResize)}},pf={resize:function(){var t,i;if(!this.disabled){var u=this.options,f=this.container,e=this.containerData,o=f.offsetWidth/e.width,s=f.offsetHeight/e.height,n=Math.abs(o-1)>Math.abs(s-1)?o:s;n!==1&&(u.restore&&(t=this.getCanvasData(),i=this.getCropBoxData()),this.render(),u.restore&&(this.setCanvasData(r(t,function(i,r){t[r]=i*n})),this.setCropBoxData(r(i,function(t,r){i[r]=t*n}))))}},dblclick:function(){this.disabled||this.options.dragMode===ki||this.setDragMode(ku(this.dragBox,bt)?bi:dt)},wheel:function(n){var i=this,r=Number(this.options.wheelZoomRatio)||.1,t=1;this.disabled||(n.preventDefault(),this.wheeling)||(this.wheeling=!0,setTimeout(function(){i.wheeling=!1},50),n.deltaY?t=n.deltaY>0?1:-1:n.wheelDelta?t=-n.wheelDelta/120:n.detail&&(t=n.detail>0?1:-1),this.zoom(-t*r,n))},cropStart:function(t){var o=t.buttons,s=t.button,e,f,i;this.disabled||(t.type==="mousedown"||t.type==="pointerdown"&&t.pointerType==="mouse")&&(n(o)&&o!==1||n(s)&&s!==0||t.ctrlKey)||(e=this.options,f=this.pointers,t.changedTouches?r(t.changedTouches,function(n){f[n.identifier]=at(n)}):f[t.pointerId||0]=at(t),i=Object.keys(f).length>1&&e.zoomable&&e.zoomOnTouch?yi:ei(t.target,ft),su.test(i))&&nt(this.element,ii,{originalEvent:t,action:i})!==!1&&(t.preventDefault(),this.action=i,this.cropping=!1,i===ai&&(this.cropping=!0,u(this.dragBox,ct)))},cropMove:function(n){var u=this.action,t;!this.disabled&&u&&(t=this.pointers,n.preventDefault(),nt(this.element,ti,{originalEvent:n,action:u})!==!1)&&(n.changedTouches?r(n.changedTouches,function(n){i(t[n.identifier]||{},at(n,!0))}):i(t[n.pointerId||0]||{},at(n,!0)),this.change(n))},cropEnd:function(n){if(!this.disabled){var i=this.action,t=this.pointers;(n.changedTouches?r(n.changedTouches,function(n){delete t[n.identifier]}):delete t[n.pointerId||0],i)&&(n.preventDefault(),Object.keys(t).length||(this.action=""),this.cropping&&(this.cropping=!1,g(this.dragBox,ct,this.cropped&&this.options.modal)),nt(this.element,ni,{originalEvent:n,action:i}))}}},wf={change:function(n){var at=this.options,ot=this.canvasData,ht=this.containerData,a=this.cropBoxData,ct=this.pointers,h=this.action,s=at.aspectRatio,o=a.left,e=a.top,i=a.width,u=a.height,et=o+i,g=e+u,nt=0,k=0,ft=ht.width,d=ht.height,v=!0,lt;!s&&n.shiftKey&&(s=i&&u?i/u:1);this.limited&&(nt=a.minLeft,k=a.minTop,ft=nt+Math.min(ht.width,ot.width,ot.left+ot.width),d=k+Math.min(ht.height,ot.height,ot.top+ot.height));var st=ct[Object.keys(ct)[0]],t={x:st.endX-st.startX,y:st.endY-st.startY},w=function(n){switch(n){case y:et+t.x>ft&&(t.x=ft-et);break;case p:o+t.x<nt&&(t.x=nt-o);break;case l:e+t.y<k&&(t.y=k-e);break;case b:g+t.y>d&&(t.y=d-g)}};switch(h){case wt:o+=t.x;e+=t.y;break;case y:if(t.x>=0&&(et>=ft||s&&(e<=k||g>=d))){v=!1;break}w(y);i+=t.x;i<0&&(h=p,i=-i,o-=i);s&&(u=i/s,e+=(a.height-u)/2);break;case l:if(t.y<=0&&(e<=k||s&&(o<=nt||et>=ft))){v=!1;break}w(l);u-=t.y;e+=t.y;u<0&&(h=b,u=-u,e-=u);s&&(i=u*s,o+=(a.width-i)/2);break;case p:if(t.x<=0&&(o<=nt||s&&(e<=k||g>=d))){v=!1;break}w(p);i-=t.x;o+=t.x;i<0&&(h=y,i=-i,o-=i);s&&(u=i/s,e+=(a.height-u)/2);break;case b:if(t.y>=0&&(g>=d||s&&(o<=nt||et>=ft))){v=!1;break}w(b);u+=t.y;u<0&&(h=l,u=-u,e-=u);s&&(i=u*s,o+=(a.width-i)/2);break;case tt:if(s){if(t.y<=0&&(e<=k||et>=ft)){v=!1;break}w(l);u-=t.y;e+=t.y;i=u*s}else w(l),w(y),t.x>=0?et<ft?i+=t.x:t.y<=0&&e<=k&&(v=!1):i+=t.x,t.y<=0?e>k&&(u-=t.y,e+=t.y):(u-=t.y,e+=t.y);i<0&&u<0?(h=ut,u=-u,i=-i,e-=u,o-=i):i<0?(h=it,i=-i,o-=i):u<0&&(h=rt,u=-u,e-=u);break;case it:if(s){if(t.y<=0&&(e<=k||o<=nt)){v=!1;break}w(l);u-=t.y;e+=t.y;i=u*s;o+=a.width-i}else w(l),w(p),t.x<=0?o>nt?(i-=t.x,o+=t.x):t.y<=0&&e<=k&&(v=!1):(i-=t.x,o+=t.x),t.y<=0?e>k&&(u-=t.y,e+=t.y):(u-=t.y,e+=t.y);i<0&&u<0?(h=rt,u=-u,i=-i,e-=u,o-=i):i<0?(h=tt,i=-i,o-=i):u<0&&(h=ut,u=-u,e-=u);break;case ut:if(s){if(t.x<=0&&(o<=nt||g>=d)){v=!1;break}w(p);i-=t.x;o+=t.x;u=i/s}else w(b),w(p),t.x<=0?o>nt?(i-=t.x,o+=t.x):t.y>=0&&g>=d&&(v=!1):(i-=t.x,o+=t.x),t.y>=0?g<d&&(u+=t.y):u+=t.y;i<0&&u<0?(h=tt,u=-u,i=-i,e-=u,o-=i):i<0?(h=rt,i=-i,o-=i):u<0&&(h=it,u=-u,e-=u);break;case rt:if(s){if(t.x>=0&&(et>=ft||g>=d)){v=!1;break}w(y);i+=t.x;u=i/s}else w(b),w(y),t.x>=0?et<ft?i+=t.x:t.y>=0&&g>=d&&(v=!1):i+=t.x,t.y>=0?g<d&&(u+=t.y):u+=t.y;i<0&&u<0?(h=it,u=-u,i=-i,e-=u,o-=i):i<0?(h=ut,i=-i,o-=i):u<0&&(h=tt,u=-u,e-=u);break;case vi:this.move(t.x,t.y);v=!1;break;case yi:this.zoom(tf(ct),n);v=!1;break;case ai:if(!t.x||!t.y){v=!1;break}lt=vr(this.cropper);o=st.startX-lt.left;e=st.startY-lt.top;i=a.minWidth;u=a.minHeight;t.x>0?h=t.y>0?rt:tt:t.x<0&&(o-=i,h=t.y>0?ut:it);t.y<0&&(e-=u);this.cropped||(c(this.cropBox,f),this.cropped=!0,this.limited&&this.limitCropBox(!0,!0))}v&&(a.width=i,a.height=u,a.left=o,a.top=e,this.action=h,this.renderCropBox());r(ct,function(n){n.startX=n.endX;n.startY=n.endY})}},bf={crop:function(){return!this.ready||this.cropped||this.disabled||(this.cropped=!0,this.limitCropBox(!0,!0),this.options.modal&&u(this.dragBox,ct),c(this.cropBox,f),this.setCropBoxData(this.initialCropBoxData)),this},reset:function(){return this.ready&&!this.disabled&&(this.imageData=i({},this.initialImageData),this.canvasData=i({},this.initialCanvasData),this.cropBoxData=i({},this.initialCropBoxData),this.renderCanvas(),this.cropped&&this.renderCropBox()),this},clear:function(){return this.cropped&&!this.disabled&&(i(this.cropBoxData,{left:0,top:0,width:0,height:0}),this.cropped=!1,this.renderCropBox(),this.limitCanvas(!0,!0),this.renderCanvas(),c(this.dragBox,ct),u(this.cropBox,f)),this},replace:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:!1;return!this.disabled&&n&&(this.isImg&&(this.element.src=n),t?(this.url=n,this.image.src=n,this.ready&&(this.viewBoxImage.src=n,r(this.previews,function(t){t.getElementsByTagName("img")[0].src=n}))):(this.isImg&&(this.replaced=!0),this.options.data=null,this.uncreate(),this.load(n))),this},enable:function(){return this.ready&&this.disabled&&(this.disabled=!1,c(this.cropper,pi)),this},disable:function(){return this.ready&&!this.disabled&&(this.disabled=!0,u(this.cropper,pi)),this},destroy:function(){var n=this.element;return n[t]?(n[t]=undefined,this.isImg&&this.replaced&&(n.src=this.originalUrl),this.uncreate(),this):this},move:function(n){var t=arguments.length>1&&arguments[1]!==undefined?arguments[1]:n,i=this.canvasData,r=i.left,u=i.top;return this.moveTo(ui(n)?n:r+Number(n),ui(t)?t:u+Number(t))},moveTo:function(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t,u=this.canvasData,r=!1;return t=Number(t),i=Number(i),this.ready&&!this.disabled&&this.options.movable&&(n(t)&&(u.left=t,r=!0),n(i)&&(u.top=i,r=!0),r&&this.renderCanvas(!0)),this},zoom:function(n,t){var i=this.canvasData;return n=Number(n),n=n<0?1/(1-n):1+n,this.zoomTo(i.width*n/i.naturalWidth,null,t)},zoomTo:function(t,i,r){var v=this.options,u=this.canvasData,f=u.width,e=u.height,c=u.naturalWidth,y=u.naturalHeight,o,s;if(t=Number(t),t>=0&&this.ready&&!this.disabled&&v.zoomable){if(o=c*t,s=y*t,nt(this.element,ri,{ratio:t,oldRatio:f/c,originalEvent:r})===!1)return this;if(r){var h=this.pointers,l=vr(this.cropper),a=h&&Object.keys(h).length?rf(h):{pageX:r.pageX,pageY:r.pageY};u.left-=(o-f)*((a.pageX-l.left-u.left)/f);u.top-=(s-e)*((a.pageY-l.top-u.top)/e)}else k(i)&&n(i.x)&&n(i.y)?(u.left-=(o-f)*((i.x-u.left)/f),u.top-=(s-e)*((i.y-u.top)/e)):(u.left-=(o-f)/2,u.top-=(s-e)/2);u.width=o;u.height=s;this.renderCanvas(!0)}return this},rotate:function(n){return this.rotateTo((this.imageData.rotate||0)+Number(n))},rotateTo:function(t){return t=Number(t),n(t)&&this.ready&&!this.disabled&&this.options.rotatable&&(this.imageData.rotate=t%360,this.renderCanvas(!0,!0)),this},scaleX:function(t){var i=this.imageData.scaleY;return this.scale(t,n(i)?i:1)},scaleY:function(t){var i=this.imageData.scaleX;return this.scale(n(i)?i:1,t)},scale:function(t){var i=arguments.length>1&&arguments[1]!==undefined?arguments[1]:t,u=this.imageData,r=!1;return t=Number(t),i=Number(i),this.ready&&!this.disabled&&this.options.scalable&&(n(t)&&(u.scaleX=t,r=!0),n(i)&&(u.scaleY=i,r=!0),r&&this.renderCanvas(!0,!0)),this},getData:function(){var h=arguments.length>0&&arguments[0]!==undefined?arguments[0]:!1,u=this.options,t=this.imageData,f=this.canvasData,i=this.cropBoxData,n,e,o,s;return this.ready&&this.cropped?(n={x:i.left-f.left,y:i.top-f.top,width:i.width,height:i.height},e=t.width/t.naturalWidth,r(n,function(t,i){n[i]=t/e}),h&&(o=Math.round(n.y+n.height),s=Math.round(n.x+n.width),n.x=Math.round(n.x),n.y=Math.round(n.y),n.width=s-n.x,n.height=o-n.y)):n={x:0,y:0,width:0,height:0},u.rotatable&&(n.rotate=t.rotate||0),u.scalable&&(n.scaleX=t.scaleX||1,n.scaleY=t.scaleY||1),n},setData:function(t){var e=this.options,i=this.imageData,o=this.canvasData,r={},u,f;return this.ready&&!this.disabled&&k(t)&&(u=!1,e.rotatable&&n(t.rotate)&&t.rotate!==i.rotate&&(i.rotate=t.rotate,u=!0),e.scalable&&(n(t.scaleX)&&t.scaleX!==i.scaleX&&(i.scaleX=t.scaleX,u=!0),n(t.scaleY)&&t.scaleY!==i.scaleY&&(i.scaleY=t.scaleY,u=!0)),u&&this.renderCanvas(!0,!0),f=i.width/i.naturalWidth,n(t.x)&&(r.left=t.x*f+o.left),n(t.y)&&(r.top=t.y*f+o.top),n(t.width)&&(r.width=t.width*f),n(t.height)&&(r.height=t.height*f),this.setCropBoxData(r)),this},getContainerData:function(){return this.ready?i({},this.containerData):{}},getImageData:function(){return this.sized?i({},this.imageData):{}},getCanvasData:function(){var t=this.canvasData,n={};return this.ready&&r(["left","top","width","height","naturalWidth","naturalHeight"],function(i){n[i]=t[i]}),n},setCanvasData:function(t){var i=this.canvasData,r=i.aspectRatio;return this.ready&&!this.disabled&&k(t)&&(n(t.left)&&(i.left=t.left),n(t.top)&&(i.top=t.top),n(t.width)?(i.width=t.width,i.height=t.width/r):n(t.height)&&(i.height=t.height,i.width=t.height*r),this.renderCanvas(!0)),this},getCropBoxData:function(){var n=this.cropBoxData,t;return this.ready&&this.cropped&&(t={left:n.left,top:n.top,width:n.width,height:n.height}),t||{}},setCropBoxData:function(t){var i=this.cropBoxData,r=this.options.aspectRatio,u,f;return this.ready&&this.cropped&&!this.disabled&&k(t)&&(n(t.left)&&(i.left=t.left),n(t.top)&&(i.top=t.top),n(t.width)&&t.width!==i.width&&(u=!0,i.width=t.width),n(t.height)&&t.height!==i.height&&(f=!0,i.height=t.height),r&&(u?i.height=i.width/r:f&&(i.width=i.height*r)),this.renderCropBox()),this},getCroppedCanvas:function(){var n=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},it,r,l,e,ut,p;if(!this.ready||!window.HTMLCanvasElement)return null;if(it=this.canvasData,r=ff(this.image,this.imageData,it,n),!this.cropped)return r;var w=this.getData(),ft=w.x,et=w.y,u=w.width,s=w.height,f=r.width/Math.floor(it.naturalWidth);f!==1&&(ft*=f,et*=f,u*=f,s*=f);var rt=u/s,ot=v({aspectRatio:rt,width:n.maxWidth||Infinity,height:n.maxHeight||Infinity}),st=v({aspectRatio:rt,width:n.minWidth||0,height:n.minHeight||0},"cover"),ht=v({aspectRatio:rt,width:n.width||(f!==1?r.width:u),height:n.height||(f!==1?r.height:s)}),c=ht.width,b=ht.height;c=Math.min(ot.width,Math.max(st.width,c));b=Math.min(ot.height,Math.max(st.height,b));l=document.createElement("canvas");e=l.getContext("2d");l.width=d(c);l.height=d(b);e.fillStyle=n.fillColor||"transparent";e.fillRect(0,0,c,b);var ct=n.imageSmoothingEnabled,at=ct===void 0?!0:ct,lt=n.imageSmoothingQuality;e.imageSmoothingEnabled=at;lt&&(e.imageSmoothingQuality=lt);var k=r.width,g=r.height,t=ft,i=et,o,h,nt,tt,a,y;return t<=-u||t>k?(t=0,o=0,nt=0,a=0):t<=0?(nt=-t,t=0,o=Math.min(k,u+t),a=o):t<=k&&(nt=0,o=Math.min(u,k-t),a=o),o<=0||i<=-s||i>g?(i=0,h=0,tt=0,y=0):i<=0?(tt=-i,i=0,h=Math.min(g,s+i),y=h):i<=g&&(tt=0,h=Math.min(s,g-i),y=h),ut=[t,i,o,h],a>0&&y>0&&(p=c/u,ut.push(nt*p,tt*p,a*p,y*p)),e.drawImage.apply(e,[r].concat(li(ut.map(function(n){return Math.floor(d(n))})))),l},setAspectRatio:function(n){var t=this.options;return this.disabled||ui(n)||(t.aspectRatio=Math.max(0,n)||NaN,this.ready&&(this.initCropBox(),this.cropped&&this.renderCropBox())),this},setDragMode:function(n){var r=this.options,u=this.dragBox,f=this.face,t,i;return this.ready&&!this.disabled&&(t=n===dt,i=r.movable&&n===bi,n=t||i?n:ki,r.dragMode=n,et(u,ft,n),g(u,bt,t),g(u,kt,i),r.cropBoxMovable||(et(f,ft,n),g(f,bt,t),g(f,kt,i))),this}},kf=h.Cropper,br=function(){function n(t){var r=arguments.length>1&&arguments[1]!==undefined?arguments[1]:{};if(kr(this,n),!t||!lu.test(t.tagName))throw new Error("The first argument is required and must be an <img> or <canvas> element.");this.element=t;this.options=i({},sr,k(r)&&r);this.cropped=!1;this.disabled=!1;this.pointers={};this.ready=!1;this.reloading=!1;this.replaced=!1;this.sized=!1;this.sizing=!1;this.init()}return dr(n,[{key:"init",value:function(){var n=this.element,r=n.tagName.toLowerCase(),i;if(!n[t]){if(n[t]=this,r==="img"){if(this.isImg=!0,i=n.getAttribute("src")||"",this.originalUrl=i,!i)return;i=n.src}else r==="canvas"&&window.HTMLCanvasElement&&(i=n.toDataURL());this.load(i)}}},{key:"load",value:function(n){var u=this,f,i,t,r;if(n){if(this.url=n,this.imageData={},f=this.element,i=this.options,i.rotatable||i.scalable||(i.checkOrientation=!1),!i.checkOrientation||!window.ArrayBuffer){this.clone();return}if(hu.test(n)){cu.test(n)?this.read(sf(n)):this.clone();return}t=new XMLHttpRequest;r=this.clone.bind(this);this.reloading=!0;this.xhr=t;t.onabort=r;t.onerror=r;t.ontimeout=r;t.onprogress=function(){t.getResponseHeader("content-type")!==fr&&t.abort()};t.onload=function(){u.read(t.response)};t.onloadend=function(){u.reloading=!1;u.xhr=null};i.checkCrossOrigin&&yr(n)&&f.crossOrigin&&(n=pr(n));t.open("GET",n,!0);t.responseType="arraybuffer";t.withCredentials=f.crossOrigin==="use-credentials";t.send()}}},{key:"read",value:function(n){var r=this.options,i=this.imageData,u=cf(n),f=0,e=1,o=1,t;u>1&&(this.url=hf(n,fr),t=lf(u),f=t.rotate,e=t.scaleX,o=t.scaleY);r.rotatable&&(i.rotate=f);r.scalable&&(i.scaleX=e,i.scaleY=o);this.clone()}},{key:"clone",value:function(){var i=this.element,r=this.url,t=i.crossOrigin,f=r,n;this.options.checkCrossOrigin&&yr(r)&&(t||(t="anonymous"),f=pr(r));this.crossOrigin=t;this.crossOriginUrl=f;n=document.createElement("img");t&&(n.crossOrigin=t);n.src=f||r;n.alt=i.alt||"The image to crop";this.image=n;n.onload=this.start.bind(this);n.onerror=this.stop.bind(this);u(n,wi);i.parentNode.insertBefore(n,i.nextSibling)}},{key:"start",value:function(){var t=this,r=this.image,u,f,n,e;if(r.onload=null,r.onerror=null,this.sizing=!0,u=h.navigator&&/(?:iPad|iPhone|iPod).*?AppleWebKit/i.test(h.navigator.userAgent),f=function(n,r){i(t.imageData,{naturalWidth:n,naturalHeight:r,aspectRatio:n/r});t.initialImageData=i({},t.imageData);t.sizing=!1;t.sized=!0;t.build()},r.naturalWidth&&!u){f(r.naturalWidth,r.naturalHeight);return}n=document.createElement("img");e=document.body||document.documentElement;this.sizingImage=n;n.onload=function(){f(n.width,n.height);u||e.removeChild(n)};n.src=r.src;u||(n.style.cssText="left:0;max-height:none!important;max-width:none!important;min-height:0!important;min-width:0!important;opacity:0;position:absolute;top:0;z-index:-1;",e.appendChild(n))}},{key:"stop",value:function(){var n=this.image;n.onload=null;n.onerror=null;n.parentNode.removeChild(n);this.image=null}},{key:"build",value:function(){if(this.sized&&!this.ready){var s=this.element,n=this.options,l=this.image,a=s.parentNode,v=document.createElement("div");v.innerHTML=au;var i=v.querySelector(".".concat(t,"-container")),y=i.querySelector(".".concat(t,"-canvas")),p=i.querySelector(".".concat(t,"-drag-box")),r=i.querySelector(".".concat(t,"-crop-box")),h=r.querySelector(".".concat(t,"-face"));this.container=a;this.cropper=i;this.canvas=y;this.dragBox=p;this.cropBox=r;this.viewBox=i.querySelector(".".concat(t,"-view-box"));this.face=h;y.appendChild(l);u(s,f);a.insertBefore(i,s.nextSibling);this.isImg||c(l,wi);this.initPreview();this.bind();n.initialAspectRatio=Math.max(0,n.initialAspectRatio)||NaN;n.aspectRatio=Math.max(0,n.aspectRatio)||NaN;n.viewMode=Math.max(0,Math.min(3,Math.round(n.viewMode)))||0;u(r,f);n.guides||u(r.getElementsByClassName("".concat(t,"-dashed")),f);n.center||u(r.getElementsByClassName("".concat(t,"-center")),f);n.background&&u(i,"".concat(t,"-bg"));n.highlight||u(h,uu);n.cropBoxMovable&&(u(h,kt),et(h,ft,wt));n.cropBoxResizable||(u(r.getElementsByClassName("".concat(t,"-line")),f),u(r.getElementsByClassName("".concat(t,"-point")),f));this.render();this.ready=!0;this.setDragMode(n.dragMode);n.autoCrop&&this.crop();this.setData(n.data);e(n.ready)&&o(s,ir,n.ready,{once:!0});nt(s,ir)}}},{key:"unbuild",value:function(){this.ready&&(this.ready=!1,this.unbind(),this.resetPreview(),this.cropper.parentNode.removeChild(this.cropper),c(this.element,f))}},{key:"uncreate",value:function(){this.ready?(this.unbuild(),this.ready=!1,this.cropped=!1):this.sizing?(this.sizingImage.onload=null,this.sizing=!1,this.sized=!1):this.reloading?(this.xhr.onabort=null,this.xhr.abort()):this.image&&this.stop()}}],[{key:"noConflict",value:function(){return window.Cropper=kf,n}},{key:"setDefaults",value:function(n){i(sr,k(n)&&n)}}]),n}();return i(br.prototype,af,vf,yf,pf,wf,bf),br});const cropDefaultMaxWidth=500,cropDefaultMaxHeight=500,cropDefaultMaxDisplayDimension=1e3;var cropCropper;